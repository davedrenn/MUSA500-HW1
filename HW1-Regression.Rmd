---
title: "HW1-OLS_Regression"
output: html_document
date: "2023-10-19"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

install.packages("rgdal")
library(sf)
library(tidyverse)
library(gridExtra)

options(scipen = 999)
```

# Introduction

# Methods
## Data Cleaning

## Exploratory Data Analysis

## Multiple Regression Analysis

## Additional Analyses

## Software

# Results
## Exploratory Results

```{r data}

data <- read.csv("Data/RegressionData.csv")

```

```{r histogram}

hist(data$MEDHVAL,breaks = 50)
hist(data$PCTBACHMOR, breaks = 50)
hist(data$NBELPOV100, breaks = 50)
hist(data$PCTVACANT, breaks = 50)
hist(data$PCTSINGLES, breaks = 50)

mean(data$MEDHVAL)
mean(data$PCTBACHMOR)
mean(data$NBELPOV100)
mean(data$PCTVACANT)
mean(data$PCTSINGLES)

sd(data$MEDHVAL)
sd(data$PCTBACHMOR)
sd(data$NBELPOV100)
sd(data$PCTVACANT)
sd(data$PCTSINGLES)

```
# quick code that cehcks which variables have 0 values for logarithmic transformation 
```{r 0_value_check}
zero_columns <- apply(data, 2, function(col) any(col == 0)) 

variables_with_zero_values <- names(zero_columns[zero_columns])

cat("Columns with 0 values:", paste(variables_with_zero_values, collapse = ", "))

```
```{r log_trans}
LNMEDHVAL <- log(data$MEDHVAL)
LNPCBACHMORE <- log(1 + data$PCTBACHMOR)
LNNBELPOV100 <- log(1 + data$NBELPOV100)
LNPCTVACANT <- log(1 + data$PCTVACANT)
LNPCTSINGLES <- log(1 + data$PCTSINGLES)

hist(LNMEDHVAL)
hist(LNPCBACHMORE)
hist(LNNBELPOV100)
hist(LNPCTVACANT)
hist(LNPCTSINGLES)

```
 
# Scatter Plots - Looking at linearity between dependent variable (LNMEDHVAL) and predictors (LNNBELPOV100,data$PCTBACHMOR, data$PCTVACANT, data$PCTSINGLES  )  
 
```{r scatter}
plot(LNNBELPOV100, LNMEDHVAL)
plot(data$PCTBACHMOR,LNMEDHVAL)
plot(data$PCTVACANT,LNMEDHVAL)
plot(data$PCTSINGLES, LNMEDHVAL)
```
# Pearson correlations

```{r pearson}
predictors <- as.matrix(cbind( data$PCTBACHMOR, data$PCTVACANT,data$PCTSINGLES,LNNBELPOV100 ))

cor(predictors)
```

```{r LNMEDHVAL map}

# Change design
map <- st_read("Data/RegressionData.shp")

ggplot() +
  geom_sf(data = map, aes(fill = LNMEDHVAL), color = NA) +
  scale_fill_gradient(low = "white",high = "darkseagreen4") +
  labs(title = "Log Median Home Value")

```

```{r variables maps, fig.width = 12}
# Change designs
pctvacant_map <- ggplot() +
  geom_sf(data = map, aes(fill = PCTVACANT), color = NA) +
  scale_fill_gradient(low = "white",high = "darkblue") +
  labs(title = "Vacant",
       fill = "%")

pctsingles_map <- ggplot() +
  geom_sf(data = map, aes(fill = PCTSINGLES), color = NA) +
  scale_fill_gradient(low = "white",high = "darkorchid4") +
  labs(title = "Singles",
       fill = "%")

pctbachmor_map <- ggplot() +
  geom_sf(data = map, aes(fill = PCTBACHMOR), color = NA) +
  scale_fill_gradient(low = "white",high = "darkorange") +
  labs(title = "Bachelor's or More",
       fill = "%")

lnnbelpov100_map <- ggplot() +
  geom_sf(data = map, aes(fill = LNNBELPOV100), color = NA) +
  scale_fill_gradient(low = "white",high = "darkred") +
  labs(title = "Log Below Poverty",
       fill = "%")

grid.arrange(pctvacant_map, pctsingles_map, pctbachmor_map, lnnbelpov100_map)

```

## Regression Results

## Regression Assumptions Checks

## Additional Models

# Discussion and Limitations